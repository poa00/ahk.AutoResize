# Class AutoResize


Предназначено для изменения размеров и позиции контролов в зависимости от размеров окна.
Также можно использовать для относительного размещения элементов в проекте, без привязки к возможным в дальнейшем изменениям размеров окна.
Созданные макеты окон легко переносятся в нужную область окна или контрола. К примеру макет из примера №1, перенесён в один из контролов примера №7 без каких либо изменений.

[b]Обозначения[/b]:
[quote]
	[u]КО[/u] - клиентская область окна.
	[u]РЗ[/u] (рабочая зона) - Прямоугольник описанный отступами от краёв КО заданными в параметрах New и SetArea.
	[u]ПК[/u] -предыдущий контрол.
	[u]№[/u] - число.
	[u](Строка1|Строка2|Строка3)[/u] - один из вариантов.
	[u](first)[/u] - параметр должен быть указан первым.
	[u]край[/u] - правая или нижняя часть, в зависимости от контекста (x|w) или (y|h).[/quote]

[b]New[/b](Gui, Options = "")
[quote]	[u]Gui[/u] - имя или хэндл окна.
	[u]Options[/u] - xm№ и\или ym№ margin отступы в КО.
	Foreign - стороннее окно. Gui и Control в Item должны быть хэндлами.
	(Floor|Ceil|Round) - при значимом количестве контролов разность в округлении координат может увеличить отступы между контролами на несколько пикселей (пример 4). Указание данных опций устранит этот эффект. 
	Floor - контролы могут оказаться вровень или не доходить до края РЗ.
	Ceil - контролы могут оказаться вровень или заходить за край РЗ.
	Round - контролы могут оказаться вровень, немного не доходить или немного заходить за край РЗ.[/quote]
	
[b]SetArea[/b](Left, Top, Right, Bottom)
[quote]	Задание отступов РЗ. Отступы margin суммируются, и во избежании путаницы лучше использовать что то одно.
	Каждый параметр может быть в виде: 
	№ - пиксели, или r№ - № тысячная часть КО. 
	Опущенные параметры равны нулю. [/quote]
	
[b]Item[/b](Control, Options, Ex = "")
[quote]	Добавить новый контрол.
	[u]Control[/u] - имя или хэндл контрола. Должно быть уникальным в экземпляре, и далее использоваться в таком же виде.
	[u]Options[/u] - строка с четырьмя параметрами через запятую. x, y, w, h.
	Каждый из них может состоять из нескольких составляющих, разделённых знаками вычитания, сложения, деления или умножения. Пробелы допустимы, регистр любой.
	Деление и умножение поддерживается только с последующим за знаком числом, операция производится над всеми предыдущими вычислениями в параметре.
	
	[i]x, y:[/i]
	[b]o[/b] (first) - отсчёт от края РЗ. Сложение в таком параметре приводит к вычитанию, то есть смещению влево или вверх.
	Например для первого параметра: "o" эквивалентно "xm", только контрол будет прилегать своим правым краем, к правому краю РЗ.
	[b]z[/b] - координата края РЗ. Аналогично (xm|ym) + r.
	[b]cur[/b] - координаты и размеры контрола на момент его передачи. 

	[i]w, h:[/i]
	[b]ro[/b] (first) - остаток РЗ от края ПК.
	
	[i]Общие:[/i]
	[b]№[/b] - пиксели.
	[b]r№[/b] - № тысячная часть РЗ.
	[b]r[/b] - эквивалентно r1000.
	[b]d[/b] - с предваряющим "+" или "-". Для отладки, будет выведен MsgBox с некоторыми данными метода "Eval".
	
	([b]w[/b]|[b]h[/b]) - размер самого контрола. Может быть полезно для (x|y).
	([b]wp[/b]|[b]hp[/b]) - размер ПК.
	([b]ws[/b]|[b]hs[/b]) - размер контрола секции.
	После каждого из трёх вышеуказанных параметров можно указать число мультипликатор (то есть можно не разделять знаком умножения).
	
	([b]x[/b]|[b]y[/b]|[b]xpo[/b]|[b]ypo[/b]) - координата края ПК.
	
	([b]xso[/b]|[b]yso[/b]) - координата края секции.
	([b]xm[/b]|[b]ym[/b]) - margin отступы в КО.
	([b]xp[/b]|[b]yp[/b]) - координата ПК.
	([b]xs[/b]|[b]ys[/b]) - координата секции.
	
	Также возможно указать в виде [b]"X > Right, Y >Bottom"[/b], то есть указывать не ширину и высоту контролов, а их крайние координаты.
	[b]p[/b] - предыдущая координата, должно быть указано сразу после ">". Например "X > P + 100, Y > P + 100", будет квадратом 100х100.

	[u]Ex[/u] - одно или несколько слов разделённых пробелом.
	[i]Draw[/i] - аналог  MoveDraw. 
	[i]Section[/i] - определяет контрол как секцию. 
	[i]Save [/i]- требуется для GetArea.
	[i]IsNoPrevious[/i] - не сохранять координаты и размеры для последующих контролов для дальнейшего относительного позиционирования.[/quote]
	
[b]SetItem[/b](Control, Options, Ex = "")
[quote]	Изменить параметры заданные до этого в Item.[/quote]
	
[b]InsertItem[/b](ControlOff, Control, Options, Ex = "")
[quote]	Добавить новый контрол перед [u]ControlOff[/u].[/quote]
	
[b]RemoveItem[/b](Control, Destroy = 0)
[quote]	Удалить данные о контроле. [u]Destroy[/u] = 1 - удалить сам контрол.[/quote]

[b]GetPos[/b](Control, byref Left = "", byref Top = "", byref Right = "", byref Bottom = "", byref Width = "", byref Height = "")
[quote]	Получить координаты и размеры контрола.[/quote]
	
[b]GetArea[/b](Control, byref Left = "", byref Top = "", byref Right = "", byref Bottom = "", byref Width = "", byref Height = "")
[quote]	Извлечь отступы контрола от краёв КО. У контрола в опциях должно быть указано "Save" (см. 7 пример).[/quote]
	
[b]IsCurrentArea[/b](W = "", H = "")
[quote]	Проверяет соответствуют ли размеры КО, последним применённым в экземепляре (см. 7 пример).[/quote]
	
[b]Resize[/b](W = "", H = "")
[quote]	Обновить размеры.
	w, h - размеры КО. Если не указаны, берутся из GetWindowInfo.[/quote]
	
[b]Show[/b](Show = 1)
[quote]	Показать скрыть все контролы экземпляра.[/quote]
 
[h][url=https://raw.githubusercontent.com/serzh82saratov/AutoResize/master/AutoResize.ahk]Class AutoResize.[/url][/h]
[h][url=https://github.com/serzh82saratov/AutoResize/tree/master/Examples]Примеры.[/url][/h]
[h][url=http://forum.script-coding.com/viewtopic.php?id=14783]Обсуждение.[/url][/h]

[b]Пример №7.[/b]

[img]https://raw.githubusercontent.com/serzh82saratov/AutoResize/master/Pics/1.png[/img]

[img]https://raw.githubusercontent.com/serzh82saratov/AutoResize/master/Pics/2.png[/img]

[img]https://raw.githubusercontent.com/serzh82saratov/AutoResize/master/Pics/3.png[/img]
